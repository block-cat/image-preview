module.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}([function(e,t){e.exports=flarum.core.compat.extend},function(e,t){e.exports=flarum.core.compat["components/TextEditor"]},function(e,t){e.exports=flarum.core.compat.Component},function(e,t,r){"use strict";r.r(t);var n=r(0),i=r(1),o=r.n(i);function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=r(2),u=function(e){var t,r;function n(){return e.apply(this,arguments)||this}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,a(t,r);var i=n.prototype;return i.oninit=function(t){e.prototype.oninit.call(this,t),this.regExp=/(?<=\[upl-image-preview url=)([\w\d:\.&\?\/\-_]*)(?=\])/g,this.index=0},i.view=function(){var e=this;this.images=this.attrs.content.match(this.regExp);var t=$("#composer > div").hasClass("fullScreen");return this.images&&t?m(".ComposerBody-imagePreview",m(".ImagePreview",m(".ImagePreview-currentImage",{onmouseup:k,onmousemove:M},m("img#img_view",{src:this.images[this.index],onload:y,onmousewheel:x,ondragstart:P,onmousedown:T}),m(".zoomButtons",m("button",{onclick:b,onmouseup:_},m("i.fas.fa-search-minus")),m("button",{onclick:w,onmouseup:_},m("i.fas.fa-search")),m("button",{onclick:N,onmouseup:_},m("i.fas.fa-search-plus"))),m("button.Left",{onclick:this.changeIndexPrev.bind(this),onmouseup:_},m("i.fas.fa-chevron-left")),m("button.Right",{onclick:this.changeIndexNext.bind(this),onmouseup:_},m("i.fas.fa-chevron-right"))),m(".ImagePreview-listImage",this.images.map((function(t,r){return m("img.ImageListItem#PreviewItem-"+r,{src:t,onclick:e.imageSelectHandler.bind(e)})}))))):""},i.imageSelectHandler=function(e){document.querySelector("#img_view").removeAttribute("style"),this.index=e.path[0].id.split("-")[1],p=1,m.redraw()},i.changeIndexPrev=function(e){document.querySelector("#img_view").removeAttribute("style"),this.index=0==this.index?this.images.length-1:this.index-1,p=1,m.redraw()},i.changeIndexNext=function(e){document.querySelector("#img_view").removeAttribute("style"),this.index=(this.index+1)%this.images.length,p=1,m.redraw()},n}(r.n(c).a),p=1,l=null,s=0,f=0,d=0,h=0,g=0,v=0;function y(e){e.preventDefault(),app.forum.data.attributes["block-cat-image-preview.imgWidth"]=e.currentTarget.width,app.forum.data.attributes["block-cat-image-preview.imgHeight"]=e.currentTarget.height}function x(e){e.preventDefault(),p+=-.01*e.deltaY,p=Math.min(Math.max(1,p),3);var t=app.forum.attribute("block-cat-image-preview.imgWidth"),r=app.forum.attribute("block-cat-image-preview.imgHeight");p*t!=0&&(e.currentTarget.style.width=p*t+"px",e.currentTarget.style.height=p*r+"px"),g=p*t,v=p*r;var n=e.target.parentNode.offsetWidth,i=e.target.parentNode.offsetHeight;d=e.currentTarget.style.left.slice(0,-2),h=e.currentTarget.style.top.slice(0,-2),d=Math.min(Math.max(n-g,d),0),h=Math.min(Math.max(i-v,h),0),e.currentTarget.style.left=d+"px",e.currentTarget.style.top=h+"px"}function b(e){p-=1,p=Math.min(Math.max(1,p),3);var t=app.forum.attribute("block-cat-image-preview.imgWidth"),r=app.forum.attribute("block-cat-image-preview.imgHeight");p*t!=0&&(e.currentTarget.parentNode.parentNode.children[0].style.width=p*t+"px",e.currentTarget.parentNode.parentNode.children[0].style.height=p*r+"px"),e.currentTarget.parentNode.parentNode.children[0].style.left="0px",e.currentTarget.parentNode.parentNode.children[0].style.top="0px"}function w(e){p=1;var t=app.forum.attribute("block-cat-image-preview.imgWidth"),r=app.forum.attribute("block-cat-image-preview.imgHeight");p*t!=0&&(e.currentTarget.parentNode.parentNode.children[0].style.width=p*t+"px",e.currentTarget.parentNode.parentNode.children[0].style.height=p*r+"px"),e.currentTarget.parentNode.parentNode.children[0].style.left="0px",e.currentTarget.parentNode.parentNode.children[0].style.top="0px"}function N(e){p+=1,p=Math.min(Math.max(1,p),3);var t=app.forum.attribute("block-cat-image-preview.imgWidth"),r=app.forum.attribute("block-cat-image-preview.imgHeight");p*t!=0&&(e.currentTarget.parentNode.parentNode.children[0].style.width=p*t+"px",e.currentTarget.parentNode.parentNode.children[0].style.height=p*r+"px"),e.currentTarget.parentNode.parentNode.children[0].style.left="0px",e.currentTarget.parentNode.parentNode.children[0].style.top="0px"}function T(e){l=e.currentTarget,s=e.clientX-l.offsetLeft,f=e.clientY-l.offsetTop,g=l.offsetWidth,v=l.offsetHeight,l.style.transition="none",l.style.transition="none"}function M(e){e.preventDefault(),null!==l&&(l.style.cursor="grabbing",d+=e.clientX-s-l.offsetLeft,h+=e.clientY-f-l.offsetTop,l.style.left=d+"px",l.style.top=h+"px")}function k(e){e.preventDefault();var t=e.currentTarget.offsetWidth,r=e.currentTarget.offsetHeight;try{d=l.style.left.slice(0,-2),h=l.style.top.slice(0,-2),d=Math.min(Math.max(t-g,d),0),h=Math.min(Math.max(r-v,h),0),l.style.transition="top 100ms",l.style.transition="left 100ms",l.style.left=d+"px",l.style.top=h+"px",l.style.cursor="grab"}catch(e){}l=null,e.stopPropagation()}function P(){return!1}function _(e){e.preventDefault(),e.stopPropagation()}app.initializers.add("block-cat/image-preview",(function(){Object(n.extend)(o.a.prototype,"view",(function(e){e.children[0].children.push(m(u,{content:this.value}))}))}))}]);
//# sourceMappingURL=forum.js.map